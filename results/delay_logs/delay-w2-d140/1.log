SUBMITTED
/opt/src/lenet5.py --action train --dataPath /opt/data --batchSize 120 --endTriggerType epoch --endTriggerNum 20
2019-10-23 19:07:37 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-10-23 19:07:38 INFO  SparkContext:54 - Running Spark version 2.4.0
2019-10-23 19:07:38 INFO  SparkContext:54 - Submitted application: lenet5
2019-10-23 19:07:38 INFO  SecurityManager:54 - Changing view acls to: root
2019-10-23 19:07:38 INFO  SecurityManager:54 - Changing modify acls to: root
2019-10-23 19:07:38 INFO  SecurityManager:54 - Changing view acls groups to: 
2019-10-23 19:07:38 INFO  SecurityManager:54 - Changing modify acls groups to: 
2019-10-23 19:07:38 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
2019-10-23 19:07:38 INFO  Utils:54 - Successfully started service 'sparkDriver' on port 40547.
2019-10-23 19:07:38 INFO  SparkEnv:54 - Registering MapOutputTracker
2019-10-23 19:07:38 INFO  SparkEnv:54 - Registering BlockManagerMaster
2019-10-23 19:07:38 INFO  BlockManagerMasterEndpoint:54 - Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2019-10-23 19:07:38 INFO  BlockManagerMasterEndpoint:54 - BlockManagerMasterEndpoint up
2019-10-23 19:07:38 INFO  DiskBlockManager:54 - Created local directory at /tmp/blockmgr-426d36e1-981e-4a22-8a63-c803effa3bc6
2019-10-23 19:07:38 INFO  MemoryStore:54 - MemoryStore started with capacity 366.3 MB
2019-10-23 19:07:38 INFO  SparkEnv:54 - Registering OutputCommitCoordinator
2019-10-23 19:07:38 INFO  log:192 - Logging initialized @1953ms
2019-10-23 19:07:38 INFO  Server:351 - jetty-9.3.z-SNAPSHOT, build timestamp: unknown, git hash: unknown
2019-10-23 19:07:38 INFO  Server:419 - Started @2016ms
2019-10-23 19:07:38 INFO  AbstractConnector:278 - Started ServerConnector@15af9790{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2019-10-23 19:07:38 INFO  Utils:54 - Successfully started service 'SparkUI' on port 4040.
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5a54d742{/jobs,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5680f372{/jobs/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@478f0ba5{/jobs/job,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@45415164{/jobs/job/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@148b31dd{/stages,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2be6c2ca{/stages/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1bb1dda0{/stages/stage,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@491d236{/stages/stage/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@115853d9{/stages/pool,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@66b5a64c{/stages/pool/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1a2f77e0{/storage,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@10a506f1{/storage/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@433059a7{/storage/rdd,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@8fc104b{/storage/rdd/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@698df6c3{/environment,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5127f78d{/environment/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@101b716f{/executors,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@788d456f{/executors/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7e308f53{/executors/threadDump,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@10458487{/executors/threadDump/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5b1e0fe9{/static,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1600fa80{/,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1500afd3{/api,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@204871b4{/jobs/job/kill,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@536d82a2{/stages/stage/kill,null,AVAILABLE,@Spark}
2019-10-23 19:07:38 INFO  SparkUI:54 - Bound SparkUI to 0.0.0.0, and started at http://c5b4ab632630:4040
2019-10-23 19:07:38 INFO  SparkContext:54 - Added JAR file:///opt/big_dl/lib/bigdl-SPARK_2.4-0.9.0-jar-with-dependencies.jar at spark://c5b4ab632630:40547/jars/bigdl-SPARK_2.4-0.9.0-jar-with-dependencies.jar with timestamp 1571857658993
2019-10-23 19:07:39 INFO  SparkContext:54 - Added file file:///opt/big_dl/lib/bigdl-0.9.0-python-api.zip at spark://c5b4ab632630:40547/files/bigdl-0.9.0-python-api.zip with timestamp 1571857659016
2019-10-23 19:07:39 INFO  Utils:54 - Copying /opt/big_dl/lib/bigdl-0.9.0-python-api.zip to /tmp/spark-edf213d7-551c-40e1-bd52-79b20b4198e4/userFiles-5adb0135-e1bf-4d08-b872-10784d8edbad/bigdl-0.9.0-python-api.zip
2019-10-23 19:07:39 INFO  StandaloneAppClient$ClientEndpoint:54 - Connecting to master spark://spark-master:7077...
2019-10-23 19:07:39 INFO  TransportClientFactory:267 - Successfully created connection to spark-master/172.19.0.2:7077 after 33 ms (0 ms spent in bootstraps)
2019-10-23 19:07:39 INFO  StandaloneSchedulerBackend:54 - Connected to Spark cluster with app ID app-20191023190739-0030
2019-10-23 19:07:39 INFO  StandaloneAppClient$ClientEndpoint:54 - Executor added: app-20191023190739-0030/0 on worker-20191023153541-172.19.0.8-32881 (172.19.0.8:32881) with 1 core(s)
2019-10-23 19:07:39 INFO  StandaloneSchedulerBackend:54 - Granted executor ID app-20191023190739-0030/0 on hostPort 172.19.0.8:32881 with 1 core(s), 1024.0 MB RAM
2019-10-23 19:07:39 INFO  StandaloneAppClient$ClientEndpoint:54 - Executor added: app-20191023190739-0030/1 on worker-20191023153540-172.19.0.3-43023 (172.19.0.3:43023) with 1 core(s)
2019-10-23 19:07:39 INFO  StandaloneSchedulerBackend:54 - Granted executor ID app-20191023190739-0030/1 on hostPort 172.19.0.3:43023 with 1 core(s), 1024.0 MB RAM
2019-10-23 19:07:39 INFO  Utils:54 - Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 34485.
2019-10-23 19:07:39 INFO  NettyBlockTransferService:54 - Server created on c5b4ab632630:34485
2019-10-23 19:07:39 INFO  BlockManager:54 - Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2019-10-23 19:07:39 INFO  StandaloneAppClient$ClientEndpoint:54 - Executor updated: app-20191023190739-0030/1 is now RUNNING
2019-10-23 19:07:39 INFO  StandaloneAppClient$ClientEndpoint:54 - Executor updated: app-20191023190739-0030/0 is now RUNNING
2019-10-23 19:07:39 INFO  BlockManagerMaster:54 - Registering BlockManager BlockManagerId(driver, c5b4ab632630, 34485, None)
2019-10-23 19:07:39 INFO  BlockManagerMasterEndpoint:54 - Registering block manager c5b4ab632630:34485 with 366.3 MB RAM, BlockManagerId(driver, c5b4ab632630, 34485, None)
2019-10-23 19:07:39 INFO  BlockManagerMaster:54 - Registered BlockManager BlockManagerId(driver, c5b4ab632630, 34485, None)
2019-10-23 19:07:39 INFO  BlockManager:54 - Initialized BlockManager: BlockManagerId(driver, c5b4ab632630, 34485, None)
2019-10-23 19:07:39 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3f972840{/metrics/json,null,AVAILABLE,@Spark}
2019-10-23 19:07:41 INFO  CoarseGrainedSchedulerBackend$DriverEndpoint:54 - Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.19.0.3:34056) with ID 1
2019-10-23 19:07:41 INFO  CoarseGrainedSchedulerBackend$DriverEndpoint:54 - Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.19.0.8:33930) with ID 0
2019-10-23 19:07:41 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 172.19.0.3:41265 with 366.3 MB RAM, BlockManagerId(1, 172.19.0.3, 41265, None)
2019-10-23 19:07:41 INFO  StandaloneSchedulerBackend:54 - SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 1.0
2019-10-23 19:07:41 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 172.19.0.8:35375 with 366.3 MB RAM, BlockManagerId(0, 172.19.0.8, 35375, None)
2019-10-23 19:07:41 INFO  Engine$:112 - Auto detect executor number and executor cores number
2019-10-23 19:07:41 INFO  Engine$:114 - Executor number is 2 and executor cores number is 1
2019-10-23 19:07:42 INFO  ThreadPool$:95 - Set mkl threads to 1 on thread 19
2019-10-23 19:07:42 INFO  Engine$:404 - Find existing spark context. Checking the spark conf...
cls.getname: com.intel.analytics.bigdl.python.api.Sample
BigDLBasePickler registering: bigdl.util.common  Sample
cls.getname: com.intel.analytics.bigdl.python.api.EvaluatedResult
BigDLBasePickler registering: bigdl.util.common  EvaluatedResult
cls.getname: com.intel.analytics.bigdl.python.api.JTensor
BigDLBasePickler registering: bigdl.util.common  JTensor
cls.getname: com.intel.analytics.bigdl.python.api.JActivity
BigDLBasePickler registering: bigdl.util.common  JActivity
('Extracting', '/opt/data/train-images-idx3-ubyte.gz')
('Extracting', '/opt/data/train-labels-idx1-ubyte.gz')
('Extracting', '/opt/data/t10k-images-idx3-ubyte.gz')
('Extracting', '/opt/data/t10k-labels-idx1-ubyte.gz')
creating: createSequential
creating: createReshape
creating: createSpatialConvolution
creating: createTanh
creating: createSpatialMaxPooling
creating: createSpatialConvolution
creating: createTanh
creating: createSpatialMaxPooling
creating: createReshape
creating: createLinear
creating: createTanh
creating: createLinear
creating: createLogSoftMax
creating: createClassNLLCriterion
creating: createDefault
creating: createSGD
creating: createMaxEpoch
creating: createDistriOptimizer
disableCheckSingleton is deprecated. Please use bigdl.check.singleton instead
creating: createEveryEpoch
creating: createTop1Accuracy
creating: createEveryEpoch
2019-10-23 19:07:43 INFO  DistriOptimizer$:791 - caching training rdd ...
2019-10-23 19:07:50 ERROR TaskSetManager:70 - Task 1 in stage 0.0 failed 4 times; aborting job
Traceback (most recent call last):
  File "/opt/src/lenet5.py", line 72, in <module>
    trained_model = optimizer.optimize()
  File "/opt/big_dl/lib/bigdl-0.9.0-python-api.zip/bigdl/optim/optimizer.py", line 764, in optimize
  File "/opt/big_dl/lib/bigdl-0.9.0-python-api.zip/bigdl/util/common.py", line 634, in callJavaFunc
  File "/opt/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__
  File "/opt/spark/python/lib/py4j-0.10.7-src.zip/py4j/protocol.py", line 328, in get_return_value
py4j.protocol.Py4JJavaError: An error occurred while calling o110.optimize.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 0.0 failed 4 times, most recent failure: Lost task 1.3 in stage 0.0 (TID 4, 172.19.0.3, executor 1): java.nio.file.FileSystemException: /tmp/spark-39b33d24-6f8a-4381-9254-a68894f2435d/executor-bf73cd3b-1661-4e1c-ae09-9c80c3aa781a/spark-a5c9dfc9-2372-4ed0-985d-856dd86bb31d/-14326576431571857658993_cache -> ./bigdl-SPARK_2.4-0.9.0-jar-with-dependencies.jar: No space left on device
	at sun.nio.fs.UnixException.translateToIOException(UnixException.java:91)
	at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)
	at sun.nio.fs.UnixCopyFile.copyFile(UnixCopyFile.java:253)
	at sun.nio.fs.UnixCopyFile.copy(UnixCopyFile.java:581)
	at sun.nio.fs.UnixFileSystemProvider.copy(UnixFileSystemProvider.java:253)
	at java.nio.file.Files.copy(Files.java:1274)
	at org.apache.spark.util.Utils$.org$apache$spark$util$Utils$$copyRecursive(Utils.scala:664)
	at org.apache.spark.util.Utils$.copyFile(Utils.scala:635)
	at org.apache.spark.util.Utils$.fetchFile(Utils.scala:502)
	at org.apache.spark.executor.Executor$$anonfun$org$apache$spark$executor$Executor$$updateDependencies$5.apply(Executor.scala:805)
	at org.apache.spark.executor.Executor$$anonfun$org$apache$spark$executor$Executor$$updateDependencies$5.apply(Executor.scala:797)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:130)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:130)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:130)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at org.apache.spark.executor.Executor.org$apache$spark$executor$Executor$$updateDependencies(Executor.scala:797)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:369)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1887)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1875)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1874)
	at scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1874)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:926)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:926)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:926)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2108)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2057)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2046)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:737)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2061)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2082)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2101)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2126)
	at org.apache.spark.rdd.RDD.count(RDD.scala:1168)
	at com.intel.analytics.bigdl.dataset.DistributedDataSet$$anon$5.cache(DataSet.scala:191)
	at com.intel.analytics.bigdl.optim.AbstractOptimizer.prepareInput(AbstractOptimizer.scala:281)
	at com.intel.analytics.bigdl.optim.DistriOptimizer.prepareInput(DistriOptimizer.scala:792)
	at com.intel.analytics.bigdl.optim.DistriOptimizer.optimize(DistriOptimizer.scala:852)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.nio.file.FileSystemException: /tmp/spark-39b33d24-6f8a-4381-9254-a68894f2435d/executor-bf73cd3b-1661-4e1c-ae09-9c80c3aa781a/spark-a5c9dfc9-2372-4ed0-985d-856dd86bb31d/-14326576431571857658993_cache -> ./bigdl-SPARK_2.4-0.9.0-jar-with-dependencies.jar: No space left on device
	at sun.nio.fs.UnixException.translateToIOException(UnixException.java:91)
	at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)
	at sun.nio.fs.UnixCopyFile.copyFile(UnixCopyFile.java:253)
	at sun.nio.fs.UnixCopyFile.copy(UnixCopyFile.java:581)
	at sun.nio.fs.UnixFileSystemProvider.copy(UnixFileSystemProvider.java:253)
	at java.nio.file.Files.copy(Files.java:1274)
	at org.apache.spark.util.Utils$.org$apache$spark$util$Utils$$copyRecursive(Utils.scala:664)
	at org.apache.spark.util.Utils$.copyFile(Utils.scala:635)
	at org.apache.spark.util.Utils$.fetchFile(Utils.scala:502)
	at org.apache.spark.executor.Executor$$anonfun$org$apache$spark$executor$Executor$$updateDependencies$5.apply(Executor.scala:805)
	at org.apache.spark.executor.Executor$$anonfun$org$apache$spark$executor$Executor$$updateDependencies$5.apply(Executor.scala:797)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:130)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:130)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:130)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at org.apache.spark.executor.Executor.org$apache$spark$executor$Executor$$updateDependencies(Executor.scala:797)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:369)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more

